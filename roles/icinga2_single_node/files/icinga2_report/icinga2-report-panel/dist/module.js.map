{"version":3,"sources":["../../../icinga2-report-panel/module.ts"],"names":["_","TablePanelCtrl","tablePanelEditor","TablePanelEditorCtrl","columnOptionsTab","EditorCtrl","$scope","$q","uiSegmentSrv","factory","extend","controller","templateUrl","Icinga2ReportPanelCtrl","$injector","$rootScope","query","window","__panel","addEditorTab","dataList","datasource","type","exportUrl","getExportUrl","editor","updateExport","panel","exportTask","exportInterval","JSON","stringify","targets","render","panelDefaults","transform","pageSize","showHeader","styles","pattern","alias","dateFormat","unit","decimals","colors","colorMode","thresholds","columns","scroll","fontSize","sort","col","desc"],"mappings":";;;;;;;AAAOA,O;;AAOEC,oB,+BAAAA,c;;AAEPC,sB,+BAAAA,gB;AACAC,0B,+BAAAA,oB;;AAEOC,sB,uCAAAA,gB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAGHC,U;;;AACJ,4BAAYC,MAAZ,EAAoBC,EAApB,EAAwBC,YAAxB,EAAsC;AAAA;;AAAA,yHAC9BF,MAD8B,EACtBC,EADsB,EAClBC,YADkB;AAErC;;;QAHsBL,oB;;AAMzBE,iBAAWI,OAAX,GAAqB,UAASF,EAAT,EAAaC,YAAb,EAA2B;AAC9C,eAAOR,EAAEU,MAAF,CAASR,iBAAiBK,EAAjB,EAAqBC,YAArB,CAAT,EAA6C;AAClDG,sBAAYN,UADsC;AAElDO,uBAAa;AAFqC,SAA7C,CAAP;AAID,OALD;;UAQMC,sB;;;AAEJ,wCAAYP,MAAZ,EAAoBQ,SAApB,EAA+BC,UAA/B,EAA2C;AAAA;;AAAA;;AACzC,kJAAMT,MAAN,EAAcQ,SAAd;AACA,gBAAKC,UAAL,GAAkBA,UAAlB;AACA,gBAAKC,KAAL,GAAa,EAAb;AAEAC,iBAAOC,OAAP;AALyC;AAM1C;;;;2CAEgB;AACf,iBAAKC,YAAL,CAAkB,SAAlB,EAA6Bd,WAAWI,OAAxC,EAAiD,CAAjD;AACA,iBAAKU,YAAL,CAAkB,eAAlB,EAAmCf,gBAAnC,EAAqD,CAArD;AACD;;;yCAEcgB,Q,EAAU;AACvB,gBAAI,KAAKC,UAAL,CAAgBC,IAAhB,KAAyB,2BAA7B,EAA0D;AACxD,mBAAKC,SAAL,GAAiB,KAAKF,UAAL,CAAgBG,YAAhB,CAA6B,IAA7B,CAAjB;AACD;;AACD,2JAAqBJ,QAArB;AACD;;;uCAEYK,M,EAAQ;AACnB,iBAAKJ,UAAL,CAAgBK,YAAhB,CAA6B;AAC3B,sBAAQD,OAAOE,KAAP,CAAaC,UADM;AAE3B,0BAAYH,OAAOE,KAAP,CAAaE,cAFE;AAG3B,yBAAWC,KAAKC,SAAL,CAAe,KAAKJ,KAAL,CAAWK,OAA1B;AAHgB,aAA7B;AAKAP,mBAAOQ,MAAP;AACD;;;;QA7BkChC,c;;AAgCrCY,6BAAuBqB,aAAvB,GAAuC;AACrCF,iBAAS,CAAC,EAAD,CAD4B;AAErCG,mBAAW,uBAF0B;AAGrCC,kBAAU,IAH2B;AAIrCC,oBAAY,IAJyB;AAKrCC,gBAAQ,CAAC;AACPhB,gBAAM,MADC;AAEPiB,mBAAS,MAFF;AAGPC,iBAAO,MAHA;AAIPC,sBAAY;AAJL,SAAD,EAKL;AACDC,gBAAM,OADL;AAEDpB,gBAAM,QAFL;AAGDkB,iBAAO,EAHN;AAIDG,oBAAU,CAJT;AAKDC,kBAAQ,CAAC,wBAAD,EAA2B,0BAA3B,EAAuD,yBAAvD,CALP;AAMDC,qBAAW,IANV;AAODN,mBAAS,MAPR;AAQDO,sBAAY;AARX,SALK,CAL6B;AAoBrCC,iBAAS,EApB4B;AAqBrCC,gBAAQ,IArB6B;AAsBrCC,kBAAU,MAtB2B;AAuBrCC,cAAM;AAAEC,eAAK,CAAP;AAAUC,gBAAM;AAAhB,SAvB+B,CAyBvC;;AAzBuC,OAAvC;;2BA4BEvC,sB","file":"module.js","sourcesContent":["import _ from 'lodash';\n\n// Now, I'd like to have a moment to talk about the situation developing custom\n// panel for Grafana: With 4.5.x, all the .ts file are transpiled to .js, so it\n// can be import and reuse and extend. 4.6.x changed that, I no longer can\n// import and reuse the built-in module :(. That's why I have to copy the files,\n// including all the dependencies here and transpile and import manually.\nimport { TablePanelCtrl } from './app/plugins/panel/table/module';\nimport {\n  tablePanelEditor,\n  TablePanelEditorCtrl\n} from './app/plugins/panel/table/editor';\nimport { columnOptionsTab } from './app/plugins/panel/table/column_options';\n\n\nclass EditorCtrl extends TablePanelEditorCtrl {\n  constructor($scope, $q, uiSegmentSrv) {\n    super($scope, $q, uiSegmentSrv)\n  }\n}\n\nEditorCtrl.factory = function($q, uiSegmentSrv) {\n  return _.extend(tablePanelEditor($q, uiSegmentSrv), {\n    controller: EditorCtrl,\n    templateUrl: 'public/plugins/icinga2-report-panel/editor.html'\n  })\n}\n\n\nclass Icinga2ReportPanelCtrl extends TablePanelCtrl {\n\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector)\n    this.$rootScope = $rootScope\n    this.query = ''\n\n    window.__panel = this\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', EditorCtrl.factory, 2);\n    this.addEditorTab('Column Styles', columnOptionsTab, 3);\n  }\n\n  onDataReceived(dataList) {\n    if (this.datasource.type === 'icinga2-report-datasource') {\n      this.exportUrl = this.datasource.getExportUrl(this)\n    }\n    super.onDataReceived(dataList)\n  }\n\n  updateExport(editor) {\n    this.datasource.updateExport({\n      'task': editor.panel.exportTask,\n      'interval': editor.panel.exportInterval,\n      'targets': JSON.stringify(this.panel.targets),\n    })\n    editor.render()\n  }\n}\n\nIcinga2ReportPanelCtrl.panelDefaults = {\n  targets: [{}],\n  transform: 'timeseries_to_columns',\n  pageSize: null,\n  showHeader: true,\n  styles: [{\n    type: 'date',\n    pattern: 'Time',\n    alias: 'Time',\n    dateFormat: 'YYYY-MM-DD HH:mm:ss',\n  }, {\n    unit: 'short',\n    type: 'number',\n    alias: '',\n    decimals: 2,\n    colors: [\"rgba(245, 54, 54, 0.9)\", \"rgba(237, 129, 40, 0.89)\", \"rgba(50, 172, 45, 0.97)\"],\n    colorMode: null,\n    pattern: '/.*/',\n    thresholds: [],\n  }],\n  columns: [],\n  scroll: true,\n  fontSize: '100%',\n  sort: { col: 0, desc: true },\n}\n// Icinga2ReportPanelCtrl.templateUrl = 'template.html'\n\nexport {\n  Icinga2ReportPanelCtrl as PanelCtrl\n}\n"]}