{"version":3,"sources":["../../../../../../../icinga2-report-panel/app/plugins/panel/table/module.ts"],"names":["_","$","MetricsPanelCtrl","transformDataToTable","tablePanelEditor","columnOptionsTab","TableRenderer","TablePanelCtrl","$scope","$injector","templateSrv","annotationsSrv","$sanitize","variableSrv","targets","transform","pageSize","showHeader","styles","type","pattern","alias","dateFormat","unit","decimals","colors","colorMode","thresholds","columns","scroll","fontSize","sort","col","desc","pageIndex","panel","fields","defaults","panelDefaults","events","on","onDataReceived","bind","onDataError","onInitEditMode","onInitPanelActions","addEditorTab","actions","push","text","click","datasource","setTimeQueryStart","getAnnotations","dashboard","range","then","annotations","data","err","dataRaw","render","dataList","length","table","renderer","isTimezoneUtc","colIndex","scope","$new","tableData","render_values","publishAppEvent","templateHtml","modalClass","elem","attrs","ctrl","pageCount","getTableHeight","panelHeight","height","appendTableRows","tbodyElem","setTable","empty","html","switchPage","e","el","currentTarget","parseInt","renderPanel","appendPaginationControls","footerElem","Math","ceil","rows","startPage","max","endPage","min","paginationList","i","activeClass","pageLinkElem","append","panelElem","parents","rootElem","find","css","addClass","tooltip","selector","addFilterClicked","filterData","options","key","column","value","row","operator","setAdhocFilter","unbindDestroy","$on","off","renderData","renderingCompleted"],"mappings":"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","file":"module.js","sourcesContent":["///<reference path=\"../../../headers/common.d.ts\" />\n\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport {transformDataToTable} from './transformers';\nimport {tablePanelEditor} from './editor';\nimport {columnOptionsTab} from './column_options';\nimport {TableRenderer} from './renderer';\n\nclass TablePanelCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  pageIndex: number;\n  dataRaw: any;\n  table: any;\n  renderer: any;\n\n  panelDefaults = {\n    targets: [{}],\n    transform: 'timeseries_to_columns',\n    pageSize: null,\n    showHeader: true,\n    styles: [\n      {\n        type: 'date',\n        pattern: 'Time',\n        alias: 'Time',\n        dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      },\n      {\n        unit: 'short',\n        type: 'number',\n        alias: '',\n        decimals: 2,\n        colors: [\"rgba(245, 54, 54, 0.9)\", \"rgba(237, 129, 40, 0.89)\", \"rgba(50, 172, 45, 0.97)\"],\n        colorMode: null,\n        pattern: '/.*/',\n        thresholds: [],\n      }\n    ],\n    columns: [],\n    scroll: true,\n    fontSize: '100%',\n    sort: {col: 0, desc: true},\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, templateSrv, private annotationsSrv, private $sanitize, private variableSrv) {\n    super($scope, $injector);\n\n    this.pageIndex = 0;\n\n    if (this.panel.styles === void 0) {\n      this.panel.styles = this.panel.columns;\n      this.panel.columns = this.panel.fields;\n      delete this.panel.columns;\n      delete this.panel.fields;\n    }\n\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', tablePanelEditor, 2);\n    this.addEditorTab('Column Styles', columnOptionsTab, 3);\n  }\n\n  onInitPanelActions(actions) {\n    actions.push({text: 'Export CSV', click: 'ctrl.exportCsv()'});\n  }\n\n  issueQueries(datasource) {\n    this.pageIndex = 0;\n\n    if (this.panel.transform === 'annotations') {\n      this.setTimeQueryStart();\n      return this.annotationsSrv.getAnnotations({dashboard: this.dashboard, panel: this.panel, range: this.range})\n      .then(annotations => {\n        return {data: annotations};\n      });\n    }\n\n    return super.issueQueries(datasource);\n  }\n\n  onDataError(err) {\n    this.dataRaw = [];\n    this.render();\n  }\n\n  onDataReceived(dataList) {\n    this.dataRaw = dataList;\n    this.pageIndex = 0;\n\n    // automatically correct transform mode based on data\n    if (this.dataRaw && this.dataRaw.length) {\n      if (this.dataRaw[0].type === 'table') {\n        this.panel.transform = 'table';\n      } else {\n        if (this.dataRaw[0].type === 'docs') {\n          this.panel.transform = 'json';\n        } else {\n          if (this.panel.transform === 'table' || this.panel.transform === 'json') {\n            this.panel.transform = 'timeseries_to_rows';\n          }\n        }\n      }\n    }\n\n    this.render();\n  }\n\n  render() {\n    this.table = transformDataToTable(this.dataRaw, this.panel);\n    this.table.sort(this.panel.sort);\n\n    this.renderer = new TableRenderer(this.panel, this.table, this.dashboard.isTimezoneUtc(), this.$sanitize, this.templateSrv);\n\n    return super.render(this.table);\n  }\n\n  toggleColumnSort(col, colIndex) {\n    // remove sort flag from current column\n    if (this.table.columns[this.panel.sort.col]) {\n      this.table.columns[this.panel.sort.col].sort = false;\n    }\n\n    if (this.panel.sort.col === colIndex) {\n      if (this.panel.sort.desc) {\n        this.panel.sort.desc = false;\n      } else {\n        this.panel.sort.col = null;\n      }\n    } else {\n      this.panel.sort.col = colIndex;\n      this.panel.sort.desc = true;\n    }\n    this.render();\n  }\n\n  exportCsv() {\n    var scope = this.$scope.$new(true);\n    scope.tableData = this.renderer.render_values();\n    scope.panel = 'table';\n    this.publishAppEvent('show-modal', {\n      templateHtml: '<export-data-modal panel=\"panel\" data=\"tableData\"></export-data-modal>',\n      scope,\n      modalClass: 'modal--narrow'\n    });\n  }\n\n  link(scope, elem, attrs, ctrl: TablePanelCtrl) {\n    var data;\n    var panel = ctrl.panel;\n    var pageCount = 0;\n\n    function getTableHeight() {\n      var panelHeight = ctrl.height;\n\n      if (pageCount > 1) {\n        panelHeight -= 26;\n      }\n\n      return (panelHeight - 31) + 'px';\n    }\n\n    function appendTableRows(tbodyElem) {\n      ctrl.renderer.setTable(data);\n      tbodyElem.empty();\n      tbodyElem.html(ctrl.renderer.render(ctrl.pageIndex));\n    }\n\n    function switchPage(e) {\n      var el = $(e.currentTarget);\n      ctrl.pageIndex = (parseInt(el.text(), 10)-1);\n      renderPanel();\n    }\n\n    function appendPaginationControls(footerElem) {\n      footerElem.empty();\n\n      var pageSize = panel.pageSize || 100;\n      pageCount = Math.ceil(data.rows.length / pageSize);\n      if (pageCount === 1) {\n        return;\n      }\n\n      var startPage = Math.max(ctrl.pageIndex - 3, 0);\n      var endPage = Math.min(pageCount, startPage + 9);\n\n      var paginationList = $('<ul></ul>');\n\n      for (var i = startPage; i < endPage; i++) {\n        var activeClass = i === ctrl.pageIndex ? 'active' : '';\n        var pageLinkElem = $('<li><a class=\"table-panel-page-link pointer ' + activeClass + '\">' + (i+1) + '</a></li>');\n        paginationList.append(pageLinkElem);\n      }\n\n      footerElem.append(paginationList);\n    }\n\n    function renderPanel() {\n      var panelElem = elem.parents('.panel');\n      var rootElem = elem.find('.table-panel-scroll');\n      var tbodyElem = elem.find('tbody');\n      var footerElem = elem.find('.table-panel-footer');\n\n      elem.css({'font-size': panel.fontSize});\n      panelElem.addClass('table-panel-wrapper');\n\n      appendTableRows(tbodyElem);\n      appendPaginationControls(footerElem);\n\n      rootElem.css({'max-height': panel.scroll ? getTableHeight() : '' });\n    }\n\n    // hook up link tooltips\n    elem.tooltip({\n      selector: '[data-link-tooltip]'\n    });\n\n    function addFilterClicked(e) {\n      let filterData = $(e.currentTarget).data();\n      var options = {\n        datasource: panel.datasource,\n        key: data.columns[filterData.column].text,\n        value: data.rows[filterData.row][filterData.column],\n        operator: filterData.operator,\n      };\n\n      ctrl.variableSrv.setAdhocFilter(options);\n    }\n\n    elem.on('click', '.table-panel-page-link', switchPage);\n    elem.on('click', '.table-panel-filter-link', addFilterClicked);\n\n    var unbindDestroy = scope.$on('$destroy', function() {\n      elem.off('click', '.table-panel-page-link');\n      elem.off('click', '.table-panel-filter-link');\n      unbindDestroy();\n    });\n\n    ctrl.events.on('render', function(renderData) {\n      data = renderData || data;\n      if (data) {\n        renderPanel();\n      }\n      ctrl.renderingCompleted();\n    });\n  }\n}\n\nexport {\n  TablePanelCtrl,\n  TablePanelCtrl as PanelCtrl\n};\n"]}